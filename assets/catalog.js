// Single source of truth
window.HWA_PRODUCTS = {

  "hvac_ac_tuneup": {
    "name": "AC Precision Tune-Up (Seasonal)",
    "category": "HVAC",
    "price": 149,
    "unit": "service",
    "desc": "Performance and safety check with cleaning and system optimization. Includes temperature split, capacitor test, contactor inspection, refrigerant performance review, and airflow checks.",
    "image": "assets/img/thumb-hvac.png",
  },
  "hvac_furnace_tuneup": {
    "name": "Furnace Precision Tune-Up (Seasonal)",
    "category": "HVAC",
    "price": 149,
    "unit": "service",
    "desc": "Safety and performance tune-up. Includes combustion safety review where applicable, flame sensor inspection, electrical checks, temperature rise verification, and airflow evaluation.",
    "image": "assets/img/thumb-hvac.png",
  },
  "hvac_system_diagnostic": {
    "name": "No-Cool / No-Heat Diagnostic",
    "category": "HVAC",
    "price": 99,
    "unit": "service",
    "desc": "Professional diagnostic to identify the root cause and provide repair options. Repair costs not included.",
    "image": "assets/img/thumb-hvac.png",
  },
  "hvac_smart_thermostat": {
    "name": "Smart Thermostat (Installed)",
    "category": "HVAC",
    "price": 399,
    "unit": "installed",
    "desc": "Installed smart thermostat with setup and homeowner walkthrough. Model selected based on system compatibility.",
    "image": "assets/img/thumb-hvac.png",
  },
  "hvac_airflow_balance": {
    "name": "Airflow & Comfort Assessment",
    "category": "HVAC",
    "price": 0,
    "unit": "quote",
    "desc": "Room-by-room airflow review and duct/return evaluation. Quote provided after on-site assessment.",
    "image": "assets/img/thumb-hvac.png",
  },
  "hvac_new_system_quote": {
    "name": "New HVAC System Quote",
    "category": "HVAC",
    "price": 0,
    "unit": "quote",
    "desc": "On-site evaluation to recommend correctly sized equipment and provide good/better/best options.",
    "image": "assets/img/thumb-hvac.png",
  },

  "air_4in_filter_upgrade": {
    "name": "Aprilaire 4\" Filter Rack (Media Cabinet)",
    "category": "Air",
    "price": 699,
    "unit": "installed",
    "desc": "Installs a 4-inch media cabinet for better filtration and airflow. Cabinet size confirmed during visit.",
    "image": "assets/img/thumb-air.png",
  },
  "air_4in_filter_pack": {
    "name": "Aprilaire 4\" Replacement Filter (1-pack)",
    "category": "Air",
    "price": 79,
    "unit": "each",
    "desc": "Replacement 4-inch media filter sized to your cabinet.",
    "image": "assets/img/thumb-air.png",
  },
  "air_duct_seal_check": {
    "name": "Duct Seal + Airflow Check",
    "category": "Air",
    "price": 0,
    "unit": "included",
    "desc": "We check for bypass air, gaps, and return leaks that reduce filtration performance.",
    "image": "assets/img/thumb-air.png",
  },
  "air_humidifier": {
    "name": "Whole-Home Humidifier (Aprilaire class)",
    "category": "Air",
    "price": 899,
    "unit": "installed",
    "desc": "Adds balanced humidity for comfort, skin relief, and better sleep. Final sizing confirmed during visit.",
    "image": "assets/img/thumb-air.png",
  },
  "air_reme_halo": {
    "name": "REME HALO-LED Air Purifier",
    "category": "Air",
    "price": 1199,
    "unit": "installed",
    "desc": "Whole-home air purification to reduce odors and airborne particles. Placement confirmed during visit.",
    "image": "assets/img/thumb-air.png",
  },
  "air_purifier_addon": {
    "name": "Targeted Air Purification Add-on",
    "category": "Air",
    "price": 399,
    "unit": "installed",
    "desc": "Optional add-on purification if the home needs extra odor/allergen support.",
    "image": "assets/img/thumb-air.png",
  },
  "water_test": {
    "name": "In-Home Water Quality Test",
    "category": "Water",
    "price": 0,
    "unit": "free",
    "desc": "Free test to identify hardness, taste/odor concerns, and best-fit solutions.",
    "image": "assets/img/thumb-water.png",
  },
  "water_softener": {
    "name": "Water Softener (Sized for your home)",
    "category": "Water",
    "price": 2495,
    "unit": "installed",
    "desc": "Reduces scale, spots, and dryness. Final grain size and valve selection confirmed during visit.",
    "image": "assets/img/thumb-water.png",
  },
  "water_sediment": {
    "name": "Whole-Home Sediment Filtration",
    "category": "Water",
    "price": 595,
    "unit": "installed",
    "desc": "Helps reduce dirt/sand/rust particles and protects fixtures and equipment.",
    "image": "assets/img/thumb-water.png",
  },
  "water_ro_system": {
    "name": "Reverse Osmosis Drinking Water System",
    "category": "Water",
    "price": 1300,
    "unit": "installed",
    "desc": "Under-sink RO system for clean, great-tasting drinking water. Final options confirmed during visit.",
    "image": "assets/img/thumb-water.png",
  },
  "water_ro": {
    "name": "Reverse Osmosis Drinking Water System",
    "category": "Water",
    "price": 1300,
    "unit": "installed",
    "desc": "Under-sink RO system for clean, great-tasting drinking water. Final options confirmed during visit.",
    "image": "assets/img/thumb-water.png",
  },
  "air_aprilaire_steam_humidifier": {
    "name": "Aprilaire Steam Humidifier (Whole-Home)",
    "category": "Air",
    "price": 2495,
    "unit": "installed",
    "desc": "Steam humidifier for precise humidity control. Model and wiring confirmed during visit.",
    "image": "assets/img/thumb-air.png",
  },
  "air_dehumidifier": {
    "name": "Whole-Home Dehumidifier",
    "category": "Air",
    "price": 2795,
    "unit": "installed",
    "desc": "Reduces high humidity, musty odor, and helps comfort. Sizing confirmed during visit.",
    "image": "assets/img/thumb-air.png",
  },
  "air_uv_light": {
    "name": "UV Air Treatment (Coil/Plenum Light)",
    "category": "Air",
    "price": 995,
    "unit": "installed",
    "desc": "UV treatment near the coil to help reduce microbial buildup. Placement and model confirmed during visit.",
    "image": "assets/img/thumb-air.png",
  },
  "air_erv_ventilation": {
    "name": "Fresh Air Ventilation (ERV/Intake Setup)",
    "category": "Air",
    "price": 3495,
    "unit": "installed",
    "desc": "Introduces controlled fresh air to reduce stale air and indoor pollutants. Home-specific design required.",
    "image": "assets/img/thumb-air.png",
  },
  "water_wholehome_carbon": {
    "name": "Whole-Home Carbon Filtration",
    "category": "Water",
    "price": 1895,
    "unit": "installed",
    "desc": "Reduces chlorine taste/odor and improves water quality at every tap. Media type confirmed during visit.",
    "image": "assets/img/thumb-water.png",
  },
  "water_uv_disinfection": {
    "name": "UV Water Disinfection System",
    "category": "Water",
    "price": 1595,
    "unit": "installed",
    "desc": "UV treatment to address microbial concerns. Requires pre-filtration; final setup confirmed during visit.",
    "image": "assets/img/thumb-water.png",
  }
};

window.HWA_BUNDLES = {
  "hvac_comfort": {
    "name": "HVAC Comfort Starter",
    "items": ["hvac_system_diagnostic","hvac_airflow_balance"],
    "image": "assets/img/thumb-generic.png",
  },
  "hvac_maintenance": {
    "name": "HVAC Maintenance Bundle",
    "items": ["hvac_ac_tuneup","hvac_furnace_tuneup"],
    "image": "assets/img/thumb-generic.png",
  },
  "air_dust": {
    "title": "Dust Control Bundle",
    "items": [
      "air_4in_filter_upgrade",
      "air_duct_seal_check",
      "air_4in_filter_pack"
    ],
    "note": "High-capacity filtration plus a bypass/leak check to keep dust from recirculating.",
    "image": "assets/img/thumb-generic.png",
  },
  "air_allergies": {
    "title": "Allergy Relief Bundle",
    "items": [
      "air_4in_filter_upgrade",
      "air_duct_seal_check",
      "air_4in_filter_pack",
      "air_purifier_addon"
    ],
    "note": "Start with filtration + sealing. Add purification if symptoms persist.",
    "image": "assets/img/thumb-generic.png",
  },
  "air_pets": {
    "title": "Pet Dander Bundle",
    "items": [
      "air_4in_filter_upgrade",
      "air_duct_seal_check",
      "air_4in_filter_pack"
    ],
    "note": "Better capture for pet hair/dander and improved airflow through the return.",
    "image": "assets/img/thumb-generic.png",
  },
  "air_dry": {
    "title": "Dry Air Bundle",
    "items": [
      "air_aprilaire_steam_humidifier"
    ],
    "note": "Steam humidification for precise, comfortable humidity.",
    "image": "assets/img/thumb-generic.png",
  },
  "air_odors": {
    "title": "Odor Control Bundle",
    "items": [
      "air_4in_filter_upgrade",
      "air_duct_seal_check",
      "air_reme_halo"
    ],
    "note": "Filtration plus whole-home purification to help reduce stubborn odors.",
    "image": "assets/img/thumb-generic.png",
  },
  "water_bad_taste": {
    "title": "Better-Tasting Water Bundle",
    "items": [
      "water_test",
      "water_ro_system"
    ],
    "note": "Test first, then RO for drinking/cooking water.",
    "image": "assets/img/thumb-generic.png",
  },
  "water_hard": {
    "title": "Hard Water Bundle",
    "items": [
      "water_test",
      "water_softener"
    ],
    "note": "Softening reduces scale, spots, and appliance wear.",
    "image": "assets/img/thumb-generic.png",
  },
  "water_skin": {
    "title": "Skin & Hair Relief Bundle",
    "items": [
      "water_test",
      "water_softener"
    ],
    "note": "Soft water helps reduce dryness and improves soap effectiveness.",
    "image": "assets/img/thumb-generic.png",
  },
  "water_stains": {
    "title": "Staining & Rust Bundle",
    "items": [
      "water_test",
      "water_sediment",
      "water_softener"
    ],
    "note": "Sediment filtration + softening helps reduce staining and buildup.",
    "image": "assets/img/thumb-generic.png",
  },
  "water_contaminants": {
    "title": "Contaminant Concern Bundle",
    "items": [
      "water_test",
      "water_sediment",
      "water_ro_system"
    ],
    "note": "Layered approach - sediment protection + RO for drinking water.",
    "image": "assets/img/thumb-generic.png",
  },
  "air_humidity": {
    "title": "High Humidity / Musty Bundle",
    "items": [
      "air_dehumidifier"
    ],
    "note": "Dehumidification to reduce musty smell and improve comfort.",
    "image": "assets/img/thumb-generic.png",
  }
};


// Ensure every product has an image (template placeholder) if none provided.
(function(){
  const byCat = {
    "Water": "assets/img/thumb-water.png",
    "Air": "assets/img/thumb-air.png",
    "HVAC": "assets/img/thumb-hvac.png"
  };
  const fallback = "assets/img/thumb-generic.png";
  const prod = window.HWA_PRODUCTS || {};
  Object.keys(prod).forEach((id)=>{
    const p = prod[id] || {};
    if (!p.image) p.image = byCat[p.category] || fallback;
  });
})();


// HVAC equipment pricing matrix (range pricing)
window.HWA_HVAC_PRICING = {
  ac: {
    '1-ton': {
      basic: { text: 'AC(New R32) 1-ton Standard', price: { min: 4459, max: 6459 } },
      mid:   { text: 'AC(New R32) 1-ton Enhanced', price: { min: 4609, max: 6609 } },
      high:  { text: 'AC(New R32) 1-ton Ultimate', price: { min: 4905, max: 6905 } }
    },
    '2-ton': {
      basic: { text: 'AC(New R32) 2-ton Standard', price: { min: 4642, max: 6642 } },
      mid:   { text: 'AC(New R32) 2-ton Enhanced', price: { min: 4999, max: 6999 } },
      high:  { text: 'AC(New R32) 2-ton Ultimate', price: { min: 5393, max: 7393 } }
    },
    '3-ton': {
      basic: { text: 'AC(New R32) 3-ton Standard', price: { min: 4338, max: 6338 } },
      mid:   { text: 'AC(New R32) 3-ton Enhanced', price: { min: 5123, max: 7123 } },
      high:  { text: 'AC(New R32) 3-ton Ultimate', price: { min: 5835, max: 7835 } }
    },
    '4-ton': {
      basic: { text: 'AC(New R32) 4-ton Standard', price: { min: 5308, max: 7308 } },
      mid:   { text: 'AC(New R32) 4-ton Enhanced', price: { min: 5699, max: 7699 } },
      high:  { text: 'AC(New R32) 4-ton Ultimate', price: { min: 6392, max: 8392 } }
    },
    '5-ton': {
      basic: { text: 'AC(New R32) 5-ton Standard', price: { min: 5646, max: 7646 } },
      mid:   { text: 'AC(New R32) 5-ton Enhanced', price: { min: 5998, max: 7998 } },
      high:  { text: 'AC(New R32) 5-ton Ultimate', price: { min: 6899, max: 8899 } }
    }
  },

  furnace80: {
    '40000': {
      basic: { text: '80%+ A2L Ready Furnace 40k BTU Standard', price: { min: 3120, max: 5120 } },
      mid:   { text: '80%+ A2L Ready Furnace 40k BTU Enhanced', price: { min: 3693, max: 5693 } },
      high:  { text: '80%+ A2L Ready Furnace 40k BTU Ultimate', price: { min: 4016, max: 6016 } }
    },
    '60000': {
      basic: { text: '80%+ A2L Ready Furnace 60k BTU Standard', price: { min: 3630, max: 5630 } },
      mid:   { text: '80%+ A2L Ready Furnace 60k BTU Enhanced', price: { min: 3746, max: 5746 } },
      high:  { text: '80%+ A2L Ready Furnace 60k BTU Ultimate', price: { min: 4129, max: 6129 } }
    },
    '80000': {
      basic: { text: '80%+ A2L Ready Furnace 80k BTU Standard', price: { min: 3672, max: 5672 } },
      mid:   { text: '80%+ A2L Ready Furnace 80k BTU Enhanced', price: { min: 3790, max: 5790 } },
      high:  { text: '80%+ A2L Ready Furnace 80k BTU Ultimate', price: { min: 4282, max: 6282 } }
    },
    '100000': {
      basic: { text: '80%+ A2L Ready Furnace 100k BTU Standard', price: { min: 3819, max: 5819 } },
      mid:   { text: '80%+ A2L Ready Furnace 100k BTU Enhanced', price: { min: 3883, max: 5883 } },
      high:  { text: '80%+ A2L Ready Furnace 100k BTU Ultimate', price: { min: 4451, max: 6451 } }
    },
    '120000': {
      basic: { text: '80%+ A2L Ready Furnace 120k BTU Standard', price: { min: 4019, max: 6019 } },
      mid:   { text: '80%+ A2L Ready Furnace 120k BTU Enhanced', price: { min: 4283, max: 6283 } },
      high:  { text: '80%+ A2L Ready Furnace 120k BTU Ultimate', price: { min: 4551, max: 6551 } }
    }
  },

  furnace90: {
    '40000': {
      basic: { text: '90%+ A2L Ready Furnace 40k Standard', price: { min: 3982, max: 5982 } },
      mid:   { text: '90%+ A2L Ready Furnace 40k Enhanced', price: { min: 4068, max: 6068 } },
      high:  { text: '90%+ A2L Ready Furnace 40k Ultimate', price: { min: 4374, max: 6374 } }
    },
    '60000': {
      basic: { text: '90%+ A2L Ready Furnace 60k Standard', price: { min: 4068, max: 6068 } },
      mid:   { text: '90%+ A2L Ready Furnace 60k Enhanced', price: { min: 4122, max: 6122 } },
      high:  { text: '90%+ A2L Ready Furnace 60k Ultimate', price: { min: 4695, max: 6695 } }
    },
    '80000': {
      basic: { text: '90%+ A2L Ready Furnace 80k Standard', price: { min: 4139, max: 6139 } },
      mid:   { text: '90%+ A2L Ready Furnace 80k Enhanced', price: { min: 4380, max: 6380 } },
      high:  { text: '90%+ A2L Ready Furnace 80k Ultimate', price: { min: 4982, max: 6982 } }
    },
    '100000': {
      basic: { text: '90%+ A2L Ready Furnace 100k Standard', price: { min: 4404, max: 6404 } },
      mid:   { text: '90%+ A2L Ready Furnace 100k Enhanced', price: { min: 4477, max: 6477 } },
      high:  { text: '90%+ A2L Ready Furnace 100k Ultimate', price: { min: 5189, max: 7189 } }
    },
    '120000': {
      basic: { text: '90%+ A2L Ready Furnace 120k Standard', price: { min: 4617, max: 6617 } },
      mid:   { text: '90%+ A2L Ready Furnace 120k Enhanced', price: { min: 4728, max: 6728 } },
      high:  { text: '90%+ A2L Ready Furnace 120k Ultimate', price: { min: 5048, max: 7048 } }
    }
  },

  full80: {
    '2-ton_60000': {
      basic: { text: '80%+ Full 2-ton/60k Standard', price: { min: 7600, max: 9600 } },
      mid:   { text: '80%+ Full 2-ton/60k Enhanced', price: { min: 9000, max: 11000 } },
      high:  { text: '80%+ Full 2-ton/60k Ultimate', price: { min: 10400, max: 12400 } }
    },
    '3-ton_80000': {
      basic: { text: '80%+ Full 3-ton/80k Standard', price: { min: 8100, max: 10100 } },
      mid:   { text: '80%+ Full 3-ton/80k Enhanced', price: { min: 9500, max: 11500 } },
      high:  { text: '80%+ Full 3-ton/80k Ultimate', price: { min: 10900, max: 12900 } }
    },
    '4-ton_100000': {
      basic: { text: '80%+ Full 4-ton/100k Standard', price: { min: 8600, max: 10600 } },
      mid:   { text: '80%+ Full 4-ton/100k Enhanced', price: { min: 10000, max: 12000 } },
      high:  { text: '80%+ Full 4-ton/100k Ultimate', price: { min: 11400, max: 13400 } }
    },
    '5-ton_120000': {
      basic: { text: '80%+ Full 5-ton/120k Standard', price: { min: 9100, max: 11100 } },
      mid:   { text: '80%+ Full 5-ton/120k Enhanced', price: { min: 10500, max: 12500 } },
      high:  { text: '80%+ Full 5-ton/120k Ultimate', price: { min: 11900, max: 13900 } }
    }
  },

  full90: {
    '2-ton_60000': {
      basic: { text: '90%+ Full 2-ton/60k Standard', price: { min: 8800, max: 10800 } },
      mid:   { text: '90%+ Full 2-ton/60k Enhanced', price: { min: 10200, max: 12200 } },
      high:  { text: '90%+ Full 2-ton/60k Ultimate', price: { min: 11600, max: 13600 } }
    },
    '3-ton_80000': {
      basic: { text: '90%+ Full 3-ton/80k Standard', price: { min: 9400, max: 11400 } },
      mid:   { text: '90%+ Full 3-ton/80k Enhanced', price: { min: 10800, max: 12800 } },
      high:  { text: '90%+ Full 3-ton/80k Ultimate', price: { min: 12200, max: 14200 } }
    },
    '4-ton_100000': {
      basic: { text: '90%+ Full 4-ton/100k Standard', price: { min: 10000, max: 12000 } },
      mid:   { text: '90%+ Full 4-ton/100k Enhanced', price: { min: 11400, max: 13400 } },
      high:  { text: '90%+ Full 4-ton/100k Ultimate', price: { min: 12800, max: 14800 } }
    },
    '5-ton_120000': {
      basic: { text: '90%+ Full 5-ton/120k Standard', price: { min: 10600, max: 12600 } },
      mid:   { text: '90%+ Full 5-ton/120k Enhanced', price: { min: 12000, max: 14000 } },
      high:  { text: '90%+ Full 5-ton/120k Ultimate', price: { min: 13400, max: 15400 } }
    }
  },

  heatPump: {
    '1-ton': {
      basic: { text: 'HP 1-ton Standard', price: { min: 5000, max: 7000 } },
      mid:   { text: 'HP 1-ton Enhanced', price: { min: 5600, max: 7600 } },
      high:  { text: 'HP 1-ton Ultimate', price: { min: 6200, max: 8200 } }
    },
    '2-ton': {
      basic: { text: 'HP 2-ton Standard', price: { min: 5500, max: 7500 } },
      mid:   { text: 'HP 2-ton Enhanced', price: { min: 6100, max: 8100 } },
      high:  { text: 'HP 2-ton Ultimate', price: { min: 6700, max: 8700 } }
    },
    '3-ton': {
      basic: { text: 'HP 3-ton Standard', price: { min: 6000, max: 8000 } },
      mid:   { text: 'HP 3-ton Enhanced', price: { min: 6600, max: 8600 } },
      high:  { text: 'HP 3-ton Ultimate', price: { min: 7200, max: 9200 } }
    },
    '4-ton': {
      basic: { text: 'HP 4-ton Standard', price: { min: 6500, max: 8500 } },
      mid:   { text: 'HP 4-ton Enhanced', price: { min: 7100, max: 9100 } },
      high:  { text: 'HP 4-ton Ultimate', price: { min: 7700, max: 9700 } }
    },
    '5-ton': {
      basic: { text: 'HP 5-ton Standard', price: { min: 7000, max: 9000 } },
      mid:   { text: 'HP 5-ton Enhanced', price: { min: 7600, max: 9600 } },
      high:  { text: 'HP 5-ton Ultimate', price: { min: 8200, max: 10200 } }
    }
  },

  dualFuel80: {
    '2-ton_60000': {
      basic: { text: '80%++ Dual-Fuel 2-ton/60k Standard', price: { min: 11500, max: 13500 } },
      mid:   { text: '80%++ Dual-Fuel 2-ton/60k Enhanced', price: { min: 13000, max: 15000 } },
      high:  { text: '80%++ Dual-Fuel 2-ton/60k Ultimate', price: { min: 14500, max: 16500 } }
    },
    '3-ton_80000': {
      basic: { text: '80%+ Dual-Fuel 3-ton/80k Standard', price: { min: 12200, max: 14200 } },
      mid:   { text: '80%+ Dual-Fuel 3-ton/80k Enhanced', price: { min: 13700, max: 15700 } },
      high:  { text: '80%+ Dual-Fuel 3-ton/80k Ultimate', price: { min: 15200, max: 17200 } }
    },
    '4-ton_100000': {
      basic: { text: '80%+ Dual-Fuel 4-ton/100k Standard', price: { min: 12900, max: 14900 } },
      mid:   { text: '80%+ Dual-Fuel 4-ton/100k Enhanced', price: { min: 14400, max: 16400 } },
      high:  { text: '80%+ Dual-Fuel 4-ton/100k Ultimate', price: { min: 15900, max: 17900 } }
    },
    '5-ton_120000': {
      basic: { text: '80%+ Dual-Fuel 5-ton/120k Standard', price: { min: 13600, max: 15600 } },
      mid:   { text: '80%+ Dual-Fuel 5-ton/120k Enhanced', price: { min: 15100, max: 17100 } },
      high:  { text: '80%+ Dual-Fuel 5-ton/120k Ultimate', price: { min: 16600, max: 18600 } }
    }
  },

  dualFuel90: {
    '2-ton_60000': {
      basic: { text: '90%+ Dual-Fuel 2-ton/60k Standard - eligible for up to $6,500 in rebates after inspection', price: { min: 12800, max: 14800 } },
      mid:   { text: '90%+ Dual-Fuel 2-ton/60k Enhanced - eligible for up to $6,500 in rebates after inspection', price: { min: 14300, max: 16300 } },
      high:  { text: '90%+ Dual-Fuel 2-ton/60k Ultimate - eligible for up to $6,500 in rebates after inspection', price: { min: 15800, max: 17800 } }
    },
    '3-ton_80000': {
      basic: { text: '90%+ Dual-Fuel 3-ton/80k Standard - eligible for up to $6,500 in rebates after inspection', price: { min: 13600, max: 15600 } },
      mid:   { text: '90%+ Dual-Fuel 3-ton/80k Enhanced - eligible for up to $6,500 in rebates after inspection', price: { min: 15100, max: 17100 } },
      high:  { text: '90%+ Dual-Fuel 3-ton/80k Ultimate - eligible for up to $6,500 in rebates after inspection', price: { min: 16600, max: 18600 } }
    },
    '4-ton_100000': {
      basic: { text: '90%+ Dual-Fuel 4-ton/100k Standard - eligible for up to $6,500 in rebates after inspection', price: { min: 14400, max: 16400 } },
      mid:   { text: '90%+ Dual-Fuel 4-ton/100k Enhanced - eligible for up to $6,500 in rebates after inspection', price: { min: 15900, max: 17900 } },
      high:  { text: '90%+ Dual-Fuel 4-ton/100k Ultimate - eligible for up to $6,500 in rebates after inspection', price: { min: 17400, max: 19400 } }
    },
    '5-ton_120000': {
      basic: { text: '90%+ Dual-Fuel 5-ton/120k Standard', price: { min: 15200, max: 17200 } },
      mid:   { text: '90%+ Dual-Fuel 5-ton/120k Enhanced', price: { min: 16700, max: 18700 } },
      high:  { text: '90%+ Dual-Fuel 5-ton/120k Ultimate', price: { min: 18200, max: 20200 } }
    }
  }
};

// Generate HVAC equipment products into the shop catalog
(function(){
  window.HWA_PRODUCTS = window.HWA_PRODUCTS || {};
  const prod = window.HWA_PRODUCTS;
  const byCat = { "HVAC": "assets/img/thumb-hvac.png" };
  const defaultImg = byCat.HVAC;

  const getId = (kind, key, tier)=>("hvac_pkg_" + kind + "_" + key + "_" + tier).replace(/[^\w-]/g,"_");

  Object.entries(window.HWA_HVAC_PRICING||{}).forEach(([kind, table])=>{
    Object.entries(table||{}).forEach(([key, tiers])=>{
      Object.entries(tiers||{}).forEach(([tier, v])=>{
        const id = getId(kind, key, tier);
        if (prod[id]) return;
        const pr = v.price || {min:0,max:0};
        prod[id] = {
          name: v.text,
          category: "HVAC",
          price: { min: Number(pr.min||0), max: Number(pr.max||0) },
          short: "Estimated range based on typical installations. Final pricing confirmed after inspection.",
          unit: "system",
          image: defaultImg
        };
      });
    });
  });

  // Basic service items for tune-up/repair guidance
  if (!prod["hvac_service_tuneup"]){
    prod["hvac_service_tuneup"] = {
      name: "HVAC Precision Tune-Up (Seasonal)",
      category: "HVAC",
      price: { min: 149, max: 149 },
      unit: "service",
      short: "Seasonal performance and safety tune-up for heating or cooling systems.",
      image: defaultImg
    };
  }
  if (!prod["hvac_service_diagnostic"]){
    prod["hvac_service_diagnostic"] = {
      name: "HVAC Repair Diagnostic (Troubleshooting)",
      category: "HVAC",
      price: { min: 99, max: 99 },
      unit: "service",
      short: "Troubleshooting visit to identify the cause of the problem and provide repair options.",
      image: defaultImg
    };
  }
})();



// HWA_SUBCATEGORY_AUTO: add subcategory labels for better shop filtering
(function(){
  const prod = window.HWA_PRODUCTS || {};
  const lc = (s)=>String(s||'').toLowerCase();
  Object.keys(prod).forEach((id)=>{
    const p = prod[id] || {};
    if (p.subcategory) return;
    const cat = lc(p.category);
    const name = lc(p.name);
    if (cat === 'hvac'){
      if (id.startsWith('hvac_pkg_')) p.subcategory = 'Equipment';
      else if (name.includes('tune-up') || name.includes('tune up') || name.includes('diagnostic') || name.includes('repair') || name.includes('assessment')) p.subcategory = 'Service';
      else if (name.includes('thermostat')) p.subcategory = 'Controls';
      else p.subcategory = 'HVAC';
    }
    if (cat === 'water'){
      if (name.includes('soften')) p.subcategory = 'Water Softening';
      else if (name.includes('ro') || name.includes('reverse')) p.subcategory = 'Reverse Osmosis';
      else if (name.includes('filter') || name.includes('carbon')) p.subcategory = 'Filtration';
      else p.subcategory = 'Water';
    }
    if (cat === 'air'){
      if (name.includes('humid')) p.subcategory = 'Humidity';
      else if (name.includes('purif') || name.includes('uv') || name.includes('sanitize')) p.subcategory = 'Purification';
      else if (name.includes('filter')) p.subcategory = 'Filtration';
      else p.subcategory = 'Air';
    }
  });
})();

// HVAC equipment packages: generate shop products from window.HWA_HVAC_PRICING
(function(){
  const pricing = window.HWA_HVAC_PRICING;
  if (!pricing) return;

  const prod = window.HWA_PRODUCTS = window.HWA_PRODUCTS || {};
  const img = 'assets/img/thumb-hvac.png';

  const equipmentSubcategory = (kind)=>{
    const k = String(kind||'').toLowerCase();
    if (k === 'ac') return 'AC';
    if (k.startsWith('furnace')) return 'Furnace';
    if (k.startsWith('full')) return 'Full System';
    if (k === 'heatpump' || k === 'heat_pump' || k === 'heat-pump') return 'Heat Pump';
    if (k.startsWith('dualfuel') || k.startsWith('dual_fuel') || k.startsWith('dual-fuel')) return 'Dual Fuel System';
    return 'Equipment';
  };

  const slug = (s)=> String(s||'')
    .toLowerCase()
    .replace(/[^a-z0-9]+/g,'_')
    .replace(/^_+|_+$/g,'');

  const tiers = ['basic','mid','high'];

  Object.keys(pricing).forEach(kind=>{
    const sizes = pricing[kind];
    if (!sizes || typeof sizes !== 'object') return;
    Object.keys(sizes).forEach(sizeKey=>{
      const byTier = sizes[sizeKey];
      if (!byTier || typeof byTier !== 'object') return;
      tiers.forEach(tier=>{
        const item = byTier[tier];
        if (!item || !item.text || !item.price) return;
        const id = `hvac_equipment_${slug(kind)}_${slug(sizeKey)}_${slug(tier)}`;
        prod[id] = {
          id,
          name: String(item.text),
          category: 'HVAC',
          subcategory: equipmentSubcategory(kind),
          price: item.price,
          unit: 'estimate',
          desc: 'Price range estimate. Final pricing is confirmed after an in-home evaluation.',
          image: img
        };
      });
    });
  });
})();